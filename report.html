<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Employee Performance Visualization</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; }
    pre { background:#f6f8fa; padding:16px; border-radius:8px; overflow:auto; }
    .meta { color:#555; margin-bottom:16px; }
    .section-title { margin-top: 24px; }
  </style>
</head>
<body>
  <h1>Employee Performance Visualization</h1>
  <div class="meta">
    Contact: <strong>24f2005847@ds.study.iitm.ac.in</strong><br/>
    This page includes the Python code and the generated visualization.
  </div>

  <h2 class="section-title">Visualization: Department Distribution</h2>
  

<style>

</style>

<div id="fig_el4612457ee395-81e6-4113-b440-9bfbe4d327413575214402"></div>
<script>
function mpld3_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(mpld3) !== "undefined" && mpld3._mpld3IsLoaded){
   // already loaded: just create the figure
   !function(mpld3){
       
       mpld3.draw_figure("fig_el4612457ee395-81e6-4113-b440-9bfbe4d327413575214402", {"width": 1600.0, "height": 1000.0, "axes": [{"bbox": [0.07745659722222223, 0.18905426686151983, 0.9037934027777778, 0.7382790664718135], "xlim": [-0.5, 6.5], "ylim": [0.0, 24.15], "xdomain": [-0.5, 6.5], "ydomain": [0.0, 24.15], "xscale": "linear", "yscale": "linear", "axes": [{"position": "bottom", "nticks": 7, "tickvalues": null, "tickformat_formatter": "", "tickformat": null, "scale": "linear", "fontsize": 10.0, "grid": {"gridOn": false}, "visible": true}, {"position": "left", "nticks": 6, "tickvalues": null, "tickformat_formatter": "", "tickformat": null, "scale": "linear", "fontsize": 10.0, "grid": {"gridOn": false}, "visible": true}], "axesbg": "#FFFFFF", "axesbgalpha": null, "zoomable": true, "id": "el4612a4df9826-e275-4a91-9a70-c1156f79823e", "lines": [], "paths": [{"data": "data01", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612722ce073-d758-45d3-bf25-cb3f85796ed5", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data02", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612678a81ae-4deb-4ae7-bf29-c79d3f6ffceb", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data02", "xindex": 2, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612ca7d059b-e32d-4cc8-83d8-2462c911ec88", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data03", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46129b16b539-2eed-4356-aa68-e87ab1aa26d2", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data04", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el461209e5d8b7-049c-4a8e-89c7-fa40973dcba2", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data05", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46120366a4d6-99f3-465f-aa4b-f4607cc569d3", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data04", "xindex": 2, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46122962ed97-6242-4cdd-b429-4ca70bcd3c4d", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}], "markers": [], "texts": [{"text": "Department", "position": [0.5, -0.17751318276951755], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "hanging", "rotation": -0.0, "fontsize": 10.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el461200734869-acd8-4ddf-b60c-16c71fc97a09"}, {"text": "Count", "position": [-0.04559293871317845, 0.49999999999999994], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "auto", "rotation": -90.0, "fontsize": 10.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el461293d21a04-3a54-41c9-ae58-f77effd5e82b"}, {"text": "Department Distribution (n=100)", "position": [0.5, 1.022575022675796], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "auto", "rotation": -0.0, "fontsize": 12.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el46127ae3201e-b833-49ef-846a-c4e58a8f1b43"}], "collections": [], "images": [], "sharex": [], "sharey": []}], "data": {"data01": [[-0.4, 0.0], [0.4, 0.0], [0.4, 21.0], [-0.4, 21.0]], "data02": [[0.6, 0.0, 1.6], [1.4, 0.0, 2.4], [1.4, 15.0, 2.4], [0.6, 15.0, 1.6]], "data03": [[2.6, 0.0], [3.4, 0.0], [3.4, 14.0], [2.6, 14.0]], "data04": [[3.6, 0.0, 5.6], [4.4, 0.0, 6.4], [4.4, 6.0, 6.4], [3.6, 6.0, 5.6]], "data05": [[4.6, 0.0], [5.4, 0.0], [5.4, 23.0], [4.6, 23.0]]}, "id": "el4612457ee395-81e6-4113-b440-9bfbe4d32741", "plugins": [{"type": "reset"}, {"type": "zoom", "button": true, "enabled": false}, {"type": "boxzoom", "button": true, "enabled": false}]});
   }(mpld3);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/mpld3
   require.config({paths: {d3: "https://d3js.org/d3.v5"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.5.11.js", function(){
         
         mpld3.draw_figure("fig_el4612457ee395-81e6-4113-b440-9bfbe4d327413575214402", {"width": 1600.0, "height": 1000.0, "axes": [{"bbox": [0.07745659722222223, 0.18905426686151983, 0.9037934027777778, 0.7382790664718135], "xlim": [-0.5, 6.5], "ylim": [0.0, 24.15], "xdomain": [-0.5, 6.5], "ydomain": [0.0, 24.15], "xscale": "linear", "yscale": "linear", "axes": [{"position": "bottom", "nticks": 7, "tickvalues": null, "tickformat_formatter": "", "tickformat": null, "scale": "linear", "fontsize": 10.0, "grid": {"gridOn": false}, "visible": true}, {"position": "left", "nticks": 6, "tickvalues": null, "tickformat_formatter": "", "tickformat": null, "scale": "linear", "fontsize": 10.0, "grid": {"gridOn": false}, "visible": true}], "axesbg": "#FFFFFF", "axesbgalpha": null, "zoomable": true, "id": "el4612a4df9826-e275-4a91-9a70-c1156f79823e", "lines": [], "paths": [{"data": "data01", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612722ce073-d758-45d3-bf25-cb3f85796ed5", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data02", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612678a81ae-4deb-4ae7-bf29-c79d3f6ffceb", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data02", "xindex": 2, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612ca7d059b-e32d-4cc8-83d8-2462c911ec88", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data03", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46129b16b539-2eed-4356-aa68-e87ab1aa26d2", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data04", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el461209e5d8b7-049c-4a8e-89c7-fa40973dcba2", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data05", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46120366a4d6-99f3-465f-aa4b-f4607cc569d3", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data04", "xindex": 2, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46122962ed97-6242-4cdd-b429-4ca70bcd3c4d", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}], "markers": [], "texts": [{"text": "Department", "position": [0.5, -0.17751318276951755], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "hanging", "rotation": -0.0, "fontsize": 10.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el461200734869-acd8-4ddf-b60c-16c71fc97a09"}, {"text": "Count", "position": [-0.04559293871317845, 0.49999999999999994], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "auto", "rotation": -90.0, "fontsize": 10.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el461293d21a04-3a54-41c9-ae58-f77effd5e82b"}, {"text": "Department Distribution (n=100)", "position": [0.5, 1.022575022675796], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "auto", "rotation": -0.0, "fontsize": 12.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el46127ae3201e-b833-49ef-846a-c4e58a8f1b43"}], "collections": [], "images": [], "sharex": [], "sharey": []}], "data": {"data01": [[-0.4, 0.0], [0.4, 0.0], [0.4, 21.0], [-0.4, 21.0]], "data02": [[0.6, 0.0, 1.6], [1.4, 0.0, 2.4], [1.4, 15.0, 2.4], [0.6, 15.0, 1.6]], "data03": [[2.6, 0.0], [3.4, 0.0], [3.4, 14.0], [2.6, 14.0]], "data04": [[3.6, 0.0, 5.6], [4.4, 0.0, 6.4], [4.4, 6.0, 6.4], [3.6, 6.0, 5.6]], "data05": [[4.6, 0.0], [5.4, 0.0], [5.4, 23.0], [4.6, 23.0]]}, "id": "el4612457ee395-81e6-4113-b440-9bfbe4d32741", "plugins": [{"type": "reset"}, {"type": "zoom", "button": true, "enabled": false}, {"type": "boxzoom", "button": true, "enabled": false}]});
      });
    });
}else{
    // require.js not available: dynamically load d3 & mpld3
    mpld3_load_lib("https://d3js.org/d3.v5.js", function(){
         mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.5.11.js", function(){
                 
                 mpld3.draw_figure("fig_el4612457ee395-81e6-4113-b440-9bfbe4d327413575214402", {"width": 1600.0, "height": 1000.0, "axes": [{"bbox": [0.07745659722222223, 0.18905426686151983, 0.9037934027777778, 0.7382790664718135], "xlim": [-0.5, 6.5], "ylim": [0.0, 24.15], "xdomain": [-0.5, 6.5], "ydomain": [0.0, 24.15], "xscale": "linear", "yscale": "linear", "axes": [{"position": "bottom", "nticks": 7, "tickvalues": null, "tickformat_formatter": "", "tickformat": null, "scale": "linear", "fontsize": 10.0, "grid": {"gridOn": false}, "visible": true}, {"position": "left", "nticks": 6, "tickvalues": null, "tickformat_formatter": "", "tickformat": null, "scale": "linear", "fontsize": 10.0, "grid": {"gridOn": false}, "visible": true}], "axesbg": "#FFFFFF", "axesbgalpha": null, "zoomable": true, "id": "el4612a4df9826-e275-4a91-9a70-c1156f79823e", "lines": [], "paths": [{"data": "data01", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612722ce073-d758-45d3-bf25-cb3f85796ed5", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data02", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612678a81ae-4deb-4ae7-bf29-c79d3f6ffceb", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data02", "xindex": 2, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el4612ca7d059b-e32d-4cc8-83d8-2462c911ec88", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data03", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46129b16b539-2eed-4356-aa68-e87ab1aa26d2", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data04", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el461209e5d8b7-049c-4a8e-89c7-fa40973dcba2", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data05", "xindex": 0, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46120366a4d6-99f3-465f-aa4b-f4607cc569d3", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}, {"data": "data04", "xindex": 2, "yindex": 1, "coordinates": "data", "pathcodes": ["M", "L", "L", "L", "Z"], "id": "el46122962ed97-6242-4cdd-b429-4ca70bcd3c4d", "dasharray": "none", "alpha": 1, "facecolor": "#3173A1", "edgecolor": "none", "edgewidth": 1.0, "zorder": 1}], "markers": [], "texts": [{"text": "Department", "position": [0.5, -0.17751318276951755], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "hanging", "rotation": -0.0, "fontsize": 10.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el461200734869-acd8-4ddf-b60c-16c71fc97a09"}, {"text": "Count", "position": [-0.04559293871317845, 0.49999999999999994], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "auto", "rotation": -90.0, "fontsize": 10.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el461293d21a04-3a54-41c9-ae58-f77effd5e82b"}, {"text": "Department Distribution (n=100)", "position": [0.5, 1.022575022675796], "coordinates": "axes", "h_anchor": "middle", "v_baseline": "auto", "rotation": -0.0, "fontsize": 12.0, "color": "#000000", "alpha": 1, "zorder": 3, "id": "el46127ae3201e-b833-49ef-846a-c4e58a8f1b43"}], "collections": [], "images": [], "sharex": [], "sharey": []}], "data": {"data01": [[-0.4, 0.0], [0.4, 0.0], [0.4, 21.0], [-0.4, 21.0]], "data02": [[0.6, 0.0, 1.6], [1.4, 0.0, 2.4], [1.4, 15.0, 2.4], [0.6, 15.0, 1.6]], "data03": [[2.6, 0.0], [3.4, 0.0], [3.4, 14.0], [2.6, 14.0]], "data04": [[3.6, 0.0, 5.6], [4.4, 0.0, 6.4], [4.4, 6.0, 6.4], [3.6, 6.0, 5.6]], "data05": [[4.6, 0.0], [5.4, 0.0], [5.4, 23.0], [4.6, 23.0]]}, "id": "el4612457ee395-81e6-4113-b440-9bfbe4d32741", "plugins": [{"type": "reset"}, {"type": "zoom", "button": true, "enabled": false}, {"type": "boxzoom", "button": true, "enabled": false}]});
            })
         });
}
</script>

  <h2 class="section-title">Python Code</h2>
  <pre><code>"""
Employee Performance Visualization (Marplotlib/Seaborn + HTML export)
Contact: 24f2005847@ds.study.iitm.ac.in
- Generates a 100-row synthetic dataset with required columns (incl. 'Operations')
- Calculates frequency count for 'Operations' department
- Prints the frequency to console
- Creates a histogram (bar chart) of department distribution
- Exports a self-contained HTML (chart + code)
"""

import io
import os
import textwrap
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import mpld3

# ------------- 1) Generate dataset (100 rows) -------------
np.random.seed(42)

departments = ["Finance", "R&D", "Marketing", "IT", "Operations", "HR", "Sales"]
regions = ["Asia Pacific", "Europe", "North America", "Latin America", "Middle East & Africa"]

n = 100
employee_id = [f"EMP{str(i+1).zfill(3)}" for i in range(n)]
department = np.random.choice(departments, size=n, p=[0.15,0.15,0.15,0.15,0.25,0.075,0.075])  # ensure Ops appears often
region = np.random.choice(regions, size=n)
performance_score = np.round(np.random.normal(loc=72, scale=8, size=n), 2)
years_experience = np.random.randint(1, 16, size=n)
satisfaction_rating = np.round(np.clip(np.random.normal(loc=3.8, scale=0.7, size=n), 1, 5), 1)

df = pd.DataFrame({
    "employee_id": employee_id,
    "department": department,
    "region": region,
    "performance_score": performance_score,
    "years_experience": years_experience,
    "satisfaction_rating": satisfaction_rating
})

# Also include the exact 5 sample rows stated in the prompt at the top (override first 5 rows)
sample_rows = pd.DataFrame([
    ["EMP001","Finance","Asia Pacific",74.34,7,4.6],
    ["EMP002","R&D","Latin America",67.17,5,4.3],
    ["EMP003","Marketing","North America",71.87,9,3.6],
    ["EMP004","IT","Europe",71.98,5,3.1],
    ["EMP005","Finance","Latin America",82.42,7,3.9],
], columns=df.columns)
df.iloc[:5] = sample_rows

# Save CSV (optional artifact)
df.to_csv("employees.csv", index=False)

# ------------- 2) Calculate frequency count for 'Operations' -------------
ops_count = (df["department"] == "Operations").sum()
print(f"Frequency count for 'Operations' department: {ops_count}")

# ------------- 3) Plot histogram/bar of department distribution -------------
plt.figure(figsize=(8, 5))
ax = sns.countplot(x="department", data=df)
ax.set_title("Department Distribution (n=100)")
ax.set_xlabel("Department")
ax.set_ylabel("Count")
plt.xticks(rotation=30, ha="right")
plt.tight_layout()

# Convert matplotlib figure to interactive HTML with mpld3
chart_html = mpld3.fig_to_html(plt.gcf())
plt.close()

# ------------- 4) Embed code + visualization into a single HTML file -------------
with open(__file__, "r", encoding="utf-8") as f:
    code_text = f.read()

html = f"""<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Employee Performance Visualization</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {{ font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; }}
    pre {{ background:#f6f8fa; padding:16px; border-radius:8px; overflow:auto; }}
    .meta {{ color:#555; margin-bottom:16px; }}
    .section-title {{ margin-top: 24px; }}
  </style>
</head>
<body>
  <h1>Employee Performance Visualization</h1>
  <div class="meta">
    Contact: <strong>24f2005847@ds.study.iitm.ac.in</strong><br/>
    This page includes the Python code and the generated visualization.
  </div>

  <h2 class="section-title">Visualization: Department Distribution</h2>
  {chart_html}

  <h2 class="section-title">Python Code</h2>
  <pre><code>{textwrap.dedent(code_text)}</code></pre>
</body>
</html>
"""

with open("report.html", "w", encoding="utf-8") as f:
    f.write(html)

print("Saved HTML to report.html")
</code></pre>
</body>
</html>
